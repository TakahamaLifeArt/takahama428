/**
 * 10秒見積もり
 * log	2018-06-15 created
 */
$(function(){jQuery.extend({tax:0,printable:{},my:{"polo-shirts":[0,0,0],towel:[0,0,0],sweat:[0,0,0],"t-shirts":[0,0,0]},calc:function(){var b=$("#items > div.is-selected"),c=b.data("category"),a=b.data("color"),e=b.data("itemid");b=$("#inks > div.is-selected").data("ink");var d=$("#order_amount").val()-0||0,f=0,g=0,h={},k={};149<d&&(f=300>d?1:2);g=$.my[c][f];h[e]=d;k={amount:0,items:h,size:0,ink:b,option:0,repeat:{silk:0,digit:0,emb:0},printable:$.printable[e]};$.api(["printcharges","recommend"],
"GET",function(b){$.api(["items",e,"costs",a],"GET",function(a){g=a[0].cost;$.my[c][f]=a[0].cost;a=Math.floor((g*d+b.tot)*(1+_TAX/100));var e=Math.ceil(a/d)||0;$("#sum").text(a.toLocaleString("ja-JP"));$("#per").text(e.toLocaleString("ja-JP"))},d)},JSON.stringify(k))},init:function(){var b={},c=[];b=["silk","digit","inkjet"];$("#items > div").each(function(a){c[a]=$(this).data("itemid");$.printable[c[a]]=[]});$.when($.api(["items",c[0],"details"],"GET",function(a){a=[a[0].silk,a[0].digit,a[0].inkjet];
for(i=0;i<a.length;i++)1===a[i]&&$.printable[c[0]].push(b[i])}),$.api(["items",c[1],"details"],"GET",function(a){a=[a[0].silk,a[0].digit,a[0].inkjet];for(i=0;i<a.length;i++)1===a[i]&&$.printable[c[1]].push(b[i])}),$.api(["items",c[2],"details"],"GET",function(a){a=[a[0].silk,a[0].digit,a[0].inkjet];for(i=0;i<a.length;i++)1===a[i]&&$.printable[c[2]].push(b[i])}),$.api(["items",c[3],"details"],"GET",function(a){a=[a[0].silk,a[0].digit,a[0].inkjet];for(i=0;i<a.length;i++)1===a[i]&&$.printable[c[3]].push(b[i])})).then(function(){$.calc()})}});
$("#order_amount").on("change",$.calc);$("#items > div, #inks > div").on("click",function(){$(this).siblings().removeClass("is-selected");$(this).addClass("is-selected");$.calc()});$.init()});